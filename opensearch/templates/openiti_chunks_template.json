{
  "index_patterns": ["openiti_chunks_v*"],
  "priority": 500,
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 0,
      "refresh_interval": "1s",
      "analysis": {
        "char_filter": {
          "openiti_arabic_script_map": {
            "type": "mapping",
            "mappings": [
              "ـ => ",
              "ً => ", "ٌ => ", "ٍ => ", "َ => ", "ُ => ", "ِ => ", "ّ => ", "ْ => ",
              "ٱ => ا",
              "أ => ا", "إ => ا", "آ => ا",
              "ى => ي",
              "ة => ه",
              "ؤ => و",
              "ئ => ي",
              "ك => ک",
              "ي => ی"
            ]
          }
        },
        "normalizer": {
          "openiti_keyword_norm": {
            "type": "custom",
            "char_filter": ["openiti_arabic_script_map"],
            "filter": ["lowercase"]
          }
        },
        "analyzer": {
          "openiti_arabic_main": {
            "type": "custom",
            "char_filter": ["openiti_arabic_script_map"],
            "tokenizer": "standard",
            "filter": [
              "lowercase",
              "decimal_digit",
              "arabic_normalization",
              "stop"
            ]
          },
          "openiti_arabic_no_stem": {
            "type": "custom",
            "char_filter": ["openiti_arabic_script_map"],
            "tokenizer": "standard",
            "filter": [
              "lowercase",
              "decimal_digit",
              "arabic_normalization",
              "stop"
            ]
          },
          "openiti_persian_main": {
            "type": "custom",
            "char_filter": ["openiti_arabic_script_map"],
            "tokenizer": "standard",
            "filter": [
              "lowercase",
              "decimal_digit",
              "arabic_normalization",
              "persian_normalization",
              "stop"
            ]
          },
          "openiti_exact": {
            "type": "custom",
            "char_filter": ["openiti_arabic_script_map"],
            "tokenizer": "standard",
            "filter": [
              "lowercase",
              "decimal_digit"
            ]
          }

          /*
            If you want ICU folding:
            - install analysis-icu plugin
            - then add the analyzer below and content.folded field in mappings
          */
        }
      }
    },
    "mappings": {
      "dynamic": "strict",
      "properties": {
        "chunk_id": { "type": "keyword" },

        "work_id":    { "type": "keyword", "normalizer": "openiti_keyword_norm" },
        "version_id": { "type": "keyword", "normalizer": "openiti_keyword_norm" },
        "author_id":  { "type": "keyword", "normalizer": "openiti_keyword_norm" },

        "lang": { "type": "keyword" },
        "is_pri": { "type": "boolean" },

        "title": {
          "type": "text",
          "analyzer": "openiti_exact"
        },

        "content": {
          "type": "text",
          "analyzer": "openiti_arabic_main",
          "fields": {
            "exact":   { "type": "text", "analyzer": "openiti_exact" },
            "nostem":  { "type": "text", "analyzer": "openiti_arabic_no_stem" },
            "persian": { "type": "text", "analyzer": "openiti_persian_main" }
          }
        }
      }
    },
    "aliases": {
      "openiti_chunks": {}
    }
  },
  "_meta": {
    "description": "OpenITI chunk index template with Arabic/Persian normalization and multi-fields for exact/nostem.",
    "version": 1
  }
}
